<html>
  <head>
    <title>カンジャマンジャ文字コンバーター</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script type="text/javascript">

      function convertktol(add) {
        let str2 = add.replace(/["”]/g,"aa").replace(/[’']/g,"a").replace(/。/g,"e").replace(/_|＿/g,"i").replace(/]/g,"u").replace(/　+/g," ").replace(/<<|＜＜/g,".").replace(/><|＞＜/g,"?").replace(/\[/g,"o")
        str2 = str2.replace(/＋|\+/g,"p").replace(/＊|\*/g,"t").replace(/｜|\|/g,"k").replace(/％|%/g,"ɸ").replace(/＃|#/g,"s").replace(/・/g,"h").replace(/〇/g,"m").replace(/＠|@/g,"n").replace(/：|:/g,"ŋ").replace(/∞/g,"l").replace(/＝|=/g,"r").replace(/￥/g,"w")

        let str_split = str2.split("")
        let ary = []
        for(let i = 0; i < str_split.length;i++){
          ary.push(str_split[i])
        }
        
        for(let i = ary.length - 1; i >= 0; i--){
          if(ary[i]=="o"){
            ary.splice(i,1)
            ary.splice(i+1,0,"o")
          }
        }

        str2 = ary.join("").replace(/[＞＜><]o/g,"o").replace(/[＞＜><]/g,",")
        return(str2)
      }

      function check(){
        
        let msg = document.getElementById("msg");
        msg.innerText = convertktol(script_form.script.value);
        
      }

      function deletetext(){
        let txt = document.getElementById("input")
        let msg = document.getElementById("msg");
        txt.value = "";
        msg.value = "";
      }
    </script>

    <style>
      body{
        margin-left: 5px;
        margin-right: 5px;
        max-width: 95%;
      }
      .textbox{
        margin: 10px;
        width: 100%;
        max-width: 900px;
        min-height: 2em;

      }
      .button{
        margin-left: 10px;
      }
    </style>
  </head>

  <body>
    <h1>カンジャマンジャ文字→ラテン文字変換器</h1>
    <form action="kanzjamanzja.html" method="get" name="script_form">
      <input class="textbox" id="input" type="text" name="script">
      <script>
        const input =document.getElementById("input"); 
        input.focus();
        input.onkeypress = (e) => {
        const key = e.keyCode || e.charCode || 0;
        if (key == 13) {
          e.preventDefault();
          }
        }

        
      </script>
      </br>
      <input class="button" type="button" value="変換" onclick="return check();">
      <input class="button" type="button" value="削除" onclick="return deletetext();"
    </form>
    <textarea class="textbox" id="msg">
    </textarea>
    <script>
        const msg = document.getElementById("msg");
        msg.readOnly = true;
        msg.addEventListener("focus", event => event.target.select())
    </script>
  </body>
</html>